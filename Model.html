<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Model</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Data_Preparation.html">Data Source &amp; Prepartion</a>
</li>
<li>
  <a href="Descriptive_Analysis.html">Descriptive Analysis</a>
</li>
<li>
  <a href="Model.html">Model</a>
</li>
<li>
  <a href="Project_Report.html">Project Report</a>
</li>
<li>
  <a href="mailto:&lt;you@youremail.com&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/Huiyi-hz3023/Final-Project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Model</h1>

</div>


<div id="modeling-workflow-diagram" class="section level2">
<h2>Modeling Workflow Diagram</h2>
<pre><code>                     ┌──────────────────────────────────┐
                     │  Exploratory Data Analysis (EDA) │
                     │  - Histogram of attendance       │
                     │  - mean–variance check           │
                     │  → Identify skewness &amp; overdispersion
                     └──────────────────────────────────┘
                                     │
                                     ▼
               ┌───────────────────────────────────────────────┐
               │ Univariate Analysis                           │
               │ - Kruskal–Wallis tests for each predictor     │
               │ - Compute η² effect sizes                     │
               │ → Assess which predictors show meaningful     │
               │   variation in attendance                     │
               └───────────────────────────────────────────────┘
                                     │
                                     ▼
         ┌──────────────────────────────────────────────────────────┐
         │ Model Building: Cross-Validated Variable Selection       │
         │ - Define Simple, Medium, Full predictor sets             │
         │ - Monte Carlo CV with RMSE as performance metric         │
         │ → Select predictor set with best out-of-sample RMSE      │
         └──────────────────────────────────────────────────────────┘
                                     │
                                     ▼
         ┌──────────────────────────────────────────────────────────┐
         │ Final Model Fitting                                      │
         │ - Fit Negative Binomial regression using selected vars   │
         │ - Extract IRRs and confidence intervals                  │
         │ → Interpret effect sizes and direction of associations   │
         └──────────────────────────────────────────────────────────┘
                                     │
                                     ▼
               ┌───────────────────────────────────────────────┐
               │ Final Inference &amp; Interpretation              │
               │ - Discuss strongest predictors                │
               │ - Compare event characteristics &amp; attendance  │
               │ - Guide practical recommendations             │
               └───────────────────────────────────────────────┘</code></pre>
<div id="exploratory-distribution-plots" class="section level3">
<h3>Exploratory distribution plots</h3>
<p>Before conducting formal statistical analyses, we examined the
distribution of the outcome variable, attendance, to assess its shape
and variability. Understanding the distribution is essential for
determining whether parametric assumptions are met and for selecting an
appropriate modeling framework.</p>
<pre class="r"><code> a &lt;- ggplot(parkevent, aes(x = attendance)) +
  geom_histogram(bins = 40, fill = &quot;steelblue&quot;, color = &quot;white&quot;) +
  labs(title = &quot;Attendance Distribution (Count)&quot;,
       x = &quot;Attendance&quot;, y = &quot;Count&quot;) +
  theme_minimal()

b &lt;- ggplot(parkevent, aes(x = attendance)) +
  geom_histogram(bins = 40, fill = &quot;tomato&quot;, color = &quot;white&quot;) +
  scale_x_log10() +
  labs(title = &quot;Attendance Distribution (Log Scale)&quot;,
       x = &quot;Attendance (log10 scale)&quot;, y = &quot;Count&quot;) +
  theme_minimal()

a+b</code></pre>
<p><img src="Model_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>mean_var &lt;- parkevent |&gt;
  summarise(mean_att = mean(attendance), var_att = var(attendance)) |&gt;
  rename(
    `Mean Attendance`   = mean_att,
    `Variance of Attendance` = var_att)

knitr::kable(mean_var, digits = 2, caption = &quot;Mean and Variance of Event Attendance&quot;)</code></pre>
<table>
<caption>Mean and Variance of Event Attendance</caption>
<thead>
<tr class="header">
<th align="right">Mean Attendance</th>
<th align="right">Variance of Attendance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">74.44</td>
<td align="right">10191.33</td>
</tr>
</tbody>
</table>
<p>Exploratory plots revealed that attendance is highly right-skewed
with a long tail, and the variance greatly exceeds the mean, indicating
overdispersion. These characteristics justify the use of non-parametric
tests in the univariate stage and a Negative Binomial model for the
final multivariable analysis.</p>
</div>
<div id="univariate-analysis" class="section level3">
<h3>Univariate Analysis</h3>
<p>We first examined whether attendance differed across levels of each
categorical predictor (season, time of day, borough, event type,
location type, and audience-related indicators) using the Kruskal–Wallis
test, a non-parametric method appropriate for skewed count outcomes. For
each variable, we also computed an η² effect size to quantify the
magnitude of group differences. These results provide an initial
assessment of which predictors meaningfully explain variation in
attendance and should be considered in subsequent multivariable
modeling.</p>
<pre class="r"><code>predictors &lt;- c(&quot;season&quot;, &quot;time_period&quot;, &quot;borough&quot;,
                &quot;event_type&quot;, &quot;location_type&quot;,
                &quot;kids_friendly&quot;, &quot;senior_friendly&quot;, &quot;adults_only&quot;)

#Function to compute eta-squared for KW
eta_kw &lt;- function(x, g){
  kw &lt;- kruskal.test(x ~ g)
  H  &lt;- kw$statistic
  k  &lt;- length(unique(g))
  n  &lt;- length(x)
  eta2 &lt;- as.numeric((H - k + 1) / (n - k))
  return(eta2)
}

# Run Kruskal–Wallis tests for all predictors
kw_results &lt;- map_df(predictors, ~ {
  form &lt;- as.formula(paste(&quot;attendance ~&quot;, .x))
  
  kt  &lt;- broom::tidy(kruskal.test(form, data = parkevent))
  eta2 &lt;- eta_kw(parkevent$attendance, parkevent[[.x]])
  
  kt |&gt; 
    mutate(variable = .x,
           eta2 = eta2)
})

# Classify effect sizes ----
kw_results &lt;- kw_results |&gt; 
  mutate(effect_strength = case_when(
    eta2 &gt;= 0.14 ~ &quot;large&quot;,
    eta2 &gt;= 0.06 ~ &quot;medium&quot;,
    eta2 &gt;= 0.01 ~ &quot;small&quot;,
    TRUE ~ &quot;very small&quot;
  ))

kw_results |&gt;
  dplyr::select (variable, p.value, effect_strength) |&gt;
  dplyr::mutate(
    p.value = format(p.value, scientific = TRUE, digits = 3)) |&gt;
  knitr::kable(caption = &quot;Kruskal–Wallis Test Results: P-values and Effect Size Classification&quot;)</code></pre>
<table>
<caption>Kruskal–Wallis Test Results: P-values and Effect Size
Classification</caption>
<thead>
<tr class="header">
<th align="left">variable</th>
<th align="left">p.value</th>
<th align="left">effect_strength</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">season</td>
<td align="left">3.73e-10</td>
<td align="left">small</td>
</tr>
<tr class="even">
<td align="left">time_period</td>
<td align="left">3.22e-10</td>
<td align="left">small</td>
</tr>
<tr class="odd">
<td align="left">borough</td>
<td align="left">1.29e-29</td>
<td align="left">small</td>
</tr>
<tr class="even">
<td align="left">event_type</td>
<td align="left">1.31e-39</td>
<td align="left">medium</td>
</tr>
<tr class="odd">
<td align="left">location_type</td>
<td align="left">2.51e-50</td>
<td align="left">medium</td>
</tr>
<tr class="even">
<td align="left">kids_friendly</td>
<td align="left">1.36e-08</td>
<td align="left">small</td>
</tr>
<tr class="odd">
<td align="left">senior_friendly</td>
<td align="left">1.02e-09</td>
<td align="left">small</td>
</tr>
<tr class="even">
<td align="left">adults_only</td>
<td align="left">1.36e-08</td>
<td align="left">small</td>
</tr>
</tbody>
</table>
<p>Across all predictors, the Kruskal–Wallis tests indicated
statistically significant differences in attendance (p &lt; 0.05), with
effect sizes ranging from very small to medium. Variables with medium η²
values (event type and location type) show stronger associations with
attendance and were prioritized for inclusion in the multivariable
model.</p>
<p>To evaluate their combined predictive value and adjust for potential
confounding, we proceeded to build multivariable models.</p>
</div>
<div id="multivariable-model-negative-binomial-regression"
class="section level3">
<h3>Multivariable Model: Negative Binomial Regression</h3>
<p>To identify the predictors that best explain variation in attendance,
we compared several candidate models using cross-validated RMSE, an
unbiased measure of out-of-sample predictive performance. We used
log-linear models for this stage because they are computationally stable
and well-suited for repeated Monte Carlo cross-validation. Based on the
RMSE comparison, we selected the most predictive set of variables and
then refit the final model using Negative Binomial regression, which is
appropriate for inference with overdispersed count outcomes such as
attendance.</p>
<pre class="r"><code>#Define candidate models
form_simple &lt;- log(attendance + 1) ~ event_type + location_type

form_medium &lt;- log(attendance + 1) ~ season + time_period + borough +
  event_type + location_type

form_full &lt;- log(attendance + 1) ~ season + time_period + borough +
  event_type + location_type + kids_friendly + senior_friendly + adults_only

#cross-validated RMSE
cv_rmse &lt;- function(formula, data, n_splits = 50, test_prop = 0.1) {
  set.seed(123)
  
cv &lt;- crossv_mc(data, n_splits, test = test_prop)
  
cv &lt;- cv %&gt;%
    mutate(
      model = map(train, ~ lm(formula, data = .x)),
      rmse  = map2_dbl(model, test, ~ rmse(.x, .y))
    )
  
mean(cv$rmse)
}

rmse_simple &lt;- cv_rmse(form_simple, parkevent, n_splits = 50, test_prop = 0.1)
rmse_medium &lt;- cv_rmse(form_medium, parkevent, n_splits = 50, test_prop = 0.1)
rmse_full   &lt;- cv_rmse(form_full,   parkevent, n_splits = 50, test_prop = 0.1)

cv_results &lt;- tibble(
  model     = c(&quot;Simple&quot;, &quot;Medium&quot;, &quot;Full&quot;),
  mean_RMSE = c(rmse_simple, rmse_medium, rmse_full)
)

cv_results |&gt; knitr::kable(digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="right">mean_RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Simple</td>
<td align="right">1.46</td>
</tr>
<tr class="even">
<td align="left">Medium</td>
<td align="right">1.43</td>
</tr>
<tr class="odd">
<td align="left">Full</td>
<td align="right">1.43</td>
</tr>
</tbody>
</table>
<p>Cross-validated RMSE values were similar across the three candidate
models, with the Full model achieving the lowest prediction error (RMSE
= 1.4263). Although the difference is modest, the Full model provided
the best out-of-sample predictive performance and was therefore selected
for the final analysis.</p>
<p>Using the selected predictor set, we fit our final model with a
Negative Binomial regression:</p>
<pre class="r"><code>model_nb &lt;- glm.nb(
  attendance ~ season + time_period + borough +
    event_type + location_type + kids_friendly + senior_friendly + adults_only,
  data = parkevent
)

irr_table &lt;- tidy(model_nb, conf.int = TRUE, exponentiate = TRUE)
irr_table |&gt;  
  mutate(across(where(is.numeric), ~ round(.x, 3))) %&gt;%
  knitr::kable(caption = &quot;Negative Binomial Model Results&quot;)</code></pre>
<table style="width:100%;">
<caption>Negative Binomial Model Results</caption>
<colgroup>
<col width="37%" />
<col width="10%" />
<col width="11%" />
<col width="11%" />
<col width="8%" />
<col width="10%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">17.944</td>
<td align="right">0.470</td>
<td align="right">6.143</td>
<td align="right">0.000</td>
<td align="right">7.991</td>
<td align="right">51.611</td>
</tr>
<tr class="even">
<td align="left">seasonSpring</td>
<td align="right">1.072</td>
<td align="right">0.095</td>
<td align="right">0.730</td>
<td align="right">0.466</td>
<td align="right">0.891</td>
<td align="right">1.293</td>
</tr>
<tr class="odd">
<td align="left">seasonSummer</td>
<td align="right">0.973</td>
<td align="right">0.061</td>
<td align="right">-0.456</td>
<td align="right">0.648</td>
<td align="right">0.863</td>
<td align="right">1.095</td>
</tr>
<tr class="even">
<td align="left">seasonWinter</td>
<td align="right">0.770</td>
<td align="right">0.150</td>
<td align="right">-1.752</td>
<td align="right">0.080</td>
<td align="right">0.580</td>
<td align="right">1.040</td>
</tr>
<tr class="odd">
<td align="left">time_periodMidnight</td>
<td align="right">0.861</td>
<td align="right">0.076</td>
<td align="right">-1.981</td>
<td align="right">0.048</td>
<td align="right">0.742</td>
<td align="right">1.000</td>
</tr>
<tr class="even">
<td align="left">time_periodMorning</td>
<td align="right">0.737</td>
<td align="right">0.090</td>
<td align="right">-3.412</td>
<td align="right">0.001</td>
<td align="right">0.616</td>
<td align="right">0.885</td>
</tr>
<tr class="odd">
<td align="left">time_periodNight</td>
<td align="right">0.924</td>
<td align="right">0.061</td>
<td align="right">-1.305</td>
<td align="right">0.192</td>
<td align="right">0.820</td>
<td align="right">1.041</td>
</tr>
<tr class="even">
<td align="left">boroughBrooklyn</td>
<td align="right">1.133</td>
<td align="right">0.086</td>
<td align="right">1.449</td>
<td align="right">0.147</td>
<td align="right">0.961</td>
<td align="right">1.341</td>
</tr>
<tr class="odd">
<td align="left">boroughManhattan</td>
<td align="right">1.635</td>
<td align="right">0.073</td>
<td align="right">6.694</td>
<td align="right">0.000</td>
<td align="right">1.427</td>
<td align="right">1.876</td>
</tr>
<tr class="even">
<td align="left">boroughQueens</td>
<td align="right">1.249</td>
<td align="right">0.075</td>
<td align="right">2.979</td>
<td align="right">0.003</td>
<td align="right">1.080</td>
<td align="right">1.448</td>
</tr>
<tr class="odd">
<td align="left">boroughStaten Island</td>
<td align="right">1.402</td>
<td align="right">0.086</td>
<td align="right">3.932</td>
<td align="right">0.000</td>
<td align="right">1.189</td>
<td align="right">1.660</td>
</tr>
<tr class="even">
<td align="left">event_typeCommunity Based Event</td>
<td align="right">1.334</td>
<td align="right">0.070</td>
<td align="right">4.107</td>
<td align="right">0.000</td>
<td align="right">1.160</td>
<td align="right">1.531</td>
</tr>
<tr class="odd">
<td align="left">event_typeLocal Event</td>
<td align="right">1.032</td>
<td align="right">0.096</td>
<td align="right">0.328</td>
<td align="right">0.743</td>
<td align="right">0.855</td>
<td align="right">1.248</td>
</tr>
<tr class="even">
<td align="left">event_typeOpen House</td>
<td align="right">1.244</td>
<td align="right">0.412</td>
<td align="right">0.529</td>
<td align="right">0.597</td>
<td align="right">0.602</td>
<td align="right">3.110</td>
</tr>
<tr class="odd">
<td align="left">event_typeTournament/Competition</td>
<td align="right">2.144</td>
<td align="right">0.369</td>
<td align="right">2.065</td>
<td align="right">0.039</td>
<td align="right">1.108</td>
<td align="right">4.849</td>
</tr>
<tr class="even">
<td align="left">location_typeOther</td>
<td align="right">2.096</td>
<td align="right">0.473</td>
<td align="right">1.565</td>
<td align="right">0.118</td>
<td align="right">0.724</td>
<td align="right">4.764</td>
</tr>
<tr class="odd">
<td align="left">location_typePark</td>
<td align="right">1.992</td>
<td align="right">0.463</td>
<td align="right">1.488</td>
<td align="right">0.137</td>
<td align="right">0.699</td>
<td align="right">4.407</td>
</tr>
<tr class="even">
<td align="left">location_typePlayground</td>
<td align="right">1.303</td>
<td align="right">0.467</td>
<td align="right">0.567</td>
<td align="right">0.571</td>
<td align="right">0.455</td>
<td align="right">2.910</td>
</tr>
<tr class="odd">
<td align="left">location_typePool</td>
<td align="right">0.554</td>
<td align="right">0.470</td>
<td align="right">-1.255</td>
<td align="right">0.210</td>
<td align="right">0.192</td>
<td align="right">1.248</td>
</tr>
<tr class="even">
<td align="left">location_typeRecreation Center</td>
<td align="right">1.302</td>
<td align="right">0.466</td>
<td align="right">0.566</td>
<td align="right">0.571</td>
<td align="right">0.455</td>
<td align="right">2.903</td>
</tr>
<tr class="odd">
<td align="left">location_typeSchool</td>
<td align="right">3.991</td>
<td align="right">0.479</td>
<td align="right">2.890</td>
<td align="right">0.004</td>
<td align="right">1.366</td>
<td align="right">9.224</td>
</tr>
<tr class="even">
<td align="left">kids_friendlyTRUE</td>
<td align="right">1.741</td>
<td align="right">0.094</td>
<td align="right">5.918</td>
<td align="right">0.000</td>
<td align="right">1.454</td>
<td align="right">2.074</td>
</tr>
<tr class="odd">
<td align="left">senior_friendlyTRUE</td>
<td align="right">1.053</td>
<td align="right">0.064</td>
<td align="right">0.803</td>
<td align="right">0.422</td>
<td align="right">0.932</td>
<td align="right">1.187</td>
</tr>
</tbody>
</table>
<p>In this model, attendance is modeled as a function of season, time of
day, borough, event type, location type, and audience indicators. We
exponentiate the coefficients to obtain incidence rate ratios (IRRs) and
95% confidence intervals, which quantify the multiplicative change in
expected attendance associated with each predictor while holding the
others constant.</p>
<p>The Negative Binomial model shows that several event characteristics
are strongly associated with attendance.<br />
Compared with spring events, winter events have significantly lower
expected attendance (IRR = 0.77, 95% CI: 0.58–1.04), while summer and
fall do not differ significantly from spring.</p>
<p>Afternoon and night events attract more participants than morning
events (Afternoon: IRR = , 95% CI: –; Night: IRR = 0.92, 95% CI:
0.82–1.04). Relative to Bronx, events in Manhattan, Queens, and Staten
Island show higher attendance (IRRs ≈ 1.25-1.64), with Manhattan having
the largest effect.</p>
<p>Community-based events have higher attendance than Agency Produced
events (IRR = 1.33, 95% CI: 1.16–1.53), and events held in schools and
parks are particularly well-attended (School: IRR = 3.99, 95% CI:
1.37–9.22; Park: IRR = 1.99, 95% CI: 0.70–4.41).</p>
<p>For the audience, the kids-friendly and senior-friendly indicators
are not individually significant after adjustment for other
covariates.</p>
<pre class="r"><code>irr_table2 &lt;- irr_table %&gt;%
  filter(term != &quot;(Intercept)&quot;) %&gt;%
  mutate(
    significant = ifelse(conf.low &gt; 1 | conf.high &lt; 1, &quot;Significant&quot;, &quot;Not Significant&quot;)
  )

ggplot(irr_table2, aes(x = reorder(term, estimate), y = estimate,
                       color = significant)) +
  geom_point(size = 3) +
   geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2) +
  geom_hline(yintercept = 1, linetype = &quot;dashed&quot;) +
  scale_color_manual(values = c(&quot;Significant&quot; = &quot;red&quot;, 
                                &quot;Not Significant&quot; = &quot;steelblue&quot;)) +
  coord_flip() +
  labs(
    title = &quot;Incidence Rate Ratios (IRRs) with 95% Confidence Intervals&quot;,
    x = &quot;Predictor&quot;,
    y = &quot;IRR&quot;,
    color = &quot;&quot;
  ) +
  theme_minimal(base_size = 13)</code></pre>
<p><img src="Model_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
